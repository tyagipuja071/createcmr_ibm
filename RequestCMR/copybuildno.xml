<!--
 Filename: copybuildno.xml
 Description: Copies the build no from cmr-config.properties to a file on the server
 Author: Jeffrey Zamora
 Date: Sept 25, 2017
-->
<project name="Copy CMR Config Build No" default="copybuildno">
  
  <!-- Environment variables -->
  <property environment="env"/>
  <property name="target.file" value="${env.TARGET_BUILD_NO_FILE}" />
  
  <target name="copybuildno">
  	<property file="src/build-no.properties" prefix="cmrconfig"></property>
  	<property file="src/cmr-config.properties" prefix="cmrprefix"></property>
    <propertyfile file="src/build-no.properties">
      <entry key="BUILD" type="int" operation="+" value="1" pattern="0000"/>
    </propertyfile>
    <tstamp>
      <format property="build-time" pattern="yyyyMMdd_HHmm" />
    </tstamp>
  	<echo>Build No: ${cmrconfig.BUILD}</echo>
  	<echo>Target File: ${target.file}</echo>
    <echo>Build Time: ${build-time}</echo>
    <echo>Label: ${label}</echo>
    <echo>Environment Label: ${env.label}</echo>
  	<echo>Setting Build No to ${cmrprefix.PREFIX}${cmrconfig.BUILD}_${build-time}</echo>
  	<loadfile property="CURRENT_CMR_BUILD_VERSION" srcfile="${target.file}" />
    <echo>Current CMR Build Version: CURRENT_CMR_BUILD_VERSION</echo>
  	<!--<echo file="${target.file}" append="false">${cmrprefix.PREFIX}${cmrconfig.BUILD}_${build-time}</echo>-->
  </target>

</project>
